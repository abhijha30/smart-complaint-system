<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<link href="style.css" rel="stylesheet">
<script>
const API_URL = "/api";

async function fetchComplaints() {
    const start = document.getElementById("start").value;
    const end = document.getElementById("end").value;
    const user = prompt("Admin Username");
    const pass = prompt("Admin Password");
    const res = await fetch(`${API_URL}/admin/complaints?start=${start}&end=${end}`, {
        headers: { "Authorization": "Basic " + btoa(user + ":" + pass) }
    });
    const data = await res.json();
    const table = document.getElementById("table");
    table.innerHTML = "<tr class='bg-gray-200'><th>ID</th><th>Name</th><th>Email</th><th>Complaint</th><th>Date</th></tr>";
    data.data.forEach(c => {
        table.innerHTML += `<tr class="text-sm"><td>${c.id}</td><td>${c.name}</td><td>${c.email}</td><td>${c.complaint}</td><td>${c.created_at}</td></tr>`;
    });
}

function downloadExcel() {
    const start = document.getElementById("start").value;
    const end = document.getElementById("end").value;
    const user = prompt("Admin Username");
    const pass = prompt("Admin Password");
    window.location.href = `${API_URL}/admin/download?start=${start}&end=${end}`;
}
</script>
</head>
<body class="bg-gray-100 min-h-screen p-4">
<div class="max-w-4xl mx-auto bg-white p-6 rounded shadow-md">
    <h1 class="text-2xl font-bold mb-4 text-center">Admin Panel</h1>
    <div class="flex flex-col md:flex-row gap-2 mb-4">
        <input type="date" id="start" class="p-2 border rounded"/>
        <input type="date" id="end" class="p-2 border rounded"/>
        <button onclick="fetchComplaints()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Filter</button>
        <button onclick="downloadExcel()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Download Excel</button>
    </div>
    <div class="overflow-x-auto">
        <table id="table" class="w-full border border-gray-300"></table>
    </div>
</div>
</body>
</html>
